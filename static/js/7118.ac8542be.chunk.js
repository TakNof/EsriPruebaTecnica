"use strict";(self.webpackChunkweb_arcgis_app=self.webpackChunkweb_arcgis_app||[]).push([[7118],{70373:(e,t,i)=>{i.d(t,{w:()=>r});var n=i(18690),o=(i(81806),i(30015)),s=i(61196);class r{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:9,t=arguments.length>1?arguments[1]:void 0;this._compareMinX=p,this._compareMinY=u,this._toBBox=e=>e,this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),t&&("function"==typeof t?this._toBBox=t:this._initFormat(t)),this.clear()}destroy(){this.clear(),T.prune(),I.prune(),b.prune(),M.prune()}all(e){a(this._data,e)}search(e,t){let i=this._data;const n=this._toBBox;if(v(e,i))for(T.clear();i;){for(let o=0,s=i.children.length;o<s;o++){const s=i.children[o],r=i.leaf?n(s):s;v(e,r)&&(i.leaf?t(s):g(e,r)?a(s,t):T.push(s))}i=T.pop()}}collides(e){let t=this._data;const i=this._toBBox;if(!v(e,t))return!1;for(T.clear();t;){for(let n=0,o=t.children.length;n<o;n++){const o=t.children[n],s=t.leaf?i(o):o;if(v(e,s)){if(t.leaf||g(e,s))return!0;T.push(o)}}t=T.pop()}return!1}load(e){if(!e.length)return this;if(e.length<this._minEntries){for(let t=0,i=e.length;t<i;t++)this.insert(e[t]);return this}let t=this._build(e.slice(0,e.length),0,e.length-1,0);if(this._data.children.length)if(this._data.height===t.height)this._splitRoot(this._data,t);else{if(this._data.height<t.height){const e=this._data;this._data=t,t=e}this._insert(t,this._data.height-t.height-1,!0)}else this._data=t;return this}insert(e){return e&&this._insert(e,this._data.height-1),this}clear(){return this._data=new E([]),this}remove(e){if(!e)return this;let t,i=this._data,o=null,s=0,r=!1;const a=this._toBBox(e);for(b.clear(),M.clear();i||b.length>0;){var l;if(i||(i=b.pop(),o=b.data[b.length-1],s=null!==(l=M.pop())&&void 0!==l?l:0,r=!0),i.leaf&&(t=(0,n.qh)(i.children,e,i.children.length,i.indexHint),-1!==t))return i.children.splice(t,1),b.push(i),this._condense(b),this;r||i.leaf||!g(i,a)?o?(s++,i=o.children[s],r=!1):i=null:(b.push(i),M.push(s),s=0,o=i,i=i.children[0])}return this}toJSON(){return this._data}fromJSON(e){return this._data=e,this}_build(e,t,i,n){const o=i-t+1;let s=this._maxEntries;if(o<=s){const n=new E(e.slice(t,i+1));return l(n,this._toBBox),n}n||(n=Math.ceil(Math.log(o)/Math.log(s)),s=Math.ceil(o/s**(n-1)));const r=new A([]);r.height=n;const a=Math.ceil(o/s),d=a*Math.ceil(Math.sqrt(s));_(e,t,i,d,this._compareMinX);for(let l=t;l<=i;l+=d){const t=Math.min(l+d-1,i);_(e,l,t,a,this._compareMinY);for(let i=l;i<=t;i+=a){const o=Math.min(i+a-1,t);r.children.push(this._build(e,i,o,n-1))}}return l(r,this._toBBox),r}_insert(e,t,i){const n=this._toBBox,o=i?e:n(e);b.clear();const s=function(e,t,i,n){for(;n.push(t),!0!==t.leaf&&n.length-1!==i;){let i,n=1/0,o=1/0;for(let s=0,r=t.children.length;s<r;s++){const r=t.children[s],a=c(r),l=m(e,r)-a;l<o?(o=l,n=a<n?a:n,i=r):l===o&&a<n&&(n=a,i=r)}t=i||t.children[0]}return t}(o,this._data,t,b);for(s.children.push(e),h(s,o);t>=0&&b.data[t].children.length>this._maxEntries;)this._split(b,t),t--;!function(e,t,i){for(let n=i;n>=0;n--)h(t.data[n],e)}(o,b,t)}_split(e,t){const i=e.data[t],n=i.children.length,o=this._minEntries;this._chooseSplitAxis(i,o,n);const s=this._chooseSplitIndex(i,o,n);if(!s)return;const r=i.children.splice(s,i.children.length-s),a=i.leaf?new E(r):new A(r);a.height=i.height,l(i,this._toBBox),l(a,this._toBBox),t?e.data[t-1].children.push(a):this._splitRoot(i,a)}_splitRoot(e,t){this._data=new A([e,t]),this._data.height=e.height+1,l(this._data,this._toBBox)}_chooseSplitIndex(e,t,i){let n,o,s;n=o=1/0;for(let r=t;r<=i-t;r++){const t=d(e,0,r,this._toBBox),a=d(e,r,i,this._toBBox),l=f(t,a),h=c(t)+c(a);l<n?(n=l,s=r,o=h<o?h:o):l===n&&h<o&&(o=h,s=r)}return s}_chooseSplitAxis(e,t,i){const n=e.leaf?this._compareMinX:p,o=e.leaf?this._compareMinY:u;this._allDistMargin(e,t,i,n)<this._allDistMargin(e,t,i,o)&&e.children.sort(n)}_allDistMargin(e,t,i,n){e.children.sort(n);const o=this._toBBox,s=d(e,0,t,o),r=d(e,i-t,i,o);let a=y(s)+y(r);for(let l=t;l<i-t;l++){const t=e.children[l];h(s,e.leaf?o(t):t),a+=y(s)}for(let l=i-t-1;l>=t;l--){const t=e.children[l];h(r,e.leaf?o(t):t),a+=y(r)}return a}_condense(e){for(let t=e.length-1;t>=0;t--){const i=e.data[t];if(0===i.children.length)if(t>0){const o=e.data[t-1],s=o.children;s.splice((0,n.qh)(s,i,s.length,o.indexHint),1)}else this.clear();else l(i,this._toBBox)}}_initFormat(e){const t=["return a"," - b",";"];this._compareMinX=new Function("a","b",t.join(e[0])),this._compareMinY=new Function("a","b",t.join(e[1])),this._toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}}function a(e,t){let i=e;for(I.clear();i;){var n;if(!0===i.leaf)for(const e of i.children)t(e);else I.pushArray(i.children);i=null!==(n=I.pop())&&void 0!==n?n:null}}function l(e,t){d(e,0,e.children.length,t,e)}function d(e,t,i,n,o){o||(o=new E([])),o.minX=1/0,o.minY=1/0,o.maxX=-1/0,o.maxY=-1/0;for(let s,r=t;r<i;r++)s=e.children[r],h(o,e.leaf?n(s):s);return o}function h(e,t){e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY)}function p(e,t){return e.minX-t.minX}function u(e,t){return e.minY-t.minY}function c(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function y(e){return e.maxX-e.minX+(e.maxY-e.minY)}function m(e,t){return(Math.max(t.maxX,e.maxX)-Math.min(t.minX,e.minX))*(Math.max(t.maxY,e.maxY)-Math.min(t.minY,e.minY))}function f(e,t){const i=Math.max(e.minX,t.minX),n=Math.max(e.minY,t.minY),o=Math.min(e.maxX,t.maxX),s=Math.min(e.maxY,t.maxY);return Math.max(0,o-i)*Math.max(0,s-n)}function g(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function v(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function _(e,t,i,n,o){const r=[t,i];for(;r.length;){const t=r.pop(),i=r.pop();if(t-i<=n)continue;const a=i+Math.ceil((t-i)/n/2)*n;(0,s.q)(e,a,i,t,o),r.push(i,a,a,t)}}const T=new o.A,I=new o.A,b=new o.A,M=new o.A({deallocator:void 0});class w{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}}class x extends w{constructor(){super(...arguments),this.height=1,this.indexHint=new n.vW}}class E extends x{constructor(e){super(),this.children=e,this.leaf=!0}}class A extends x{constructor(e){super(),this.children=e,this.leaf=!1}}},33328:(e,t,i)=>{i.d(t,{F:()=>l});var n=i(81806),o=i(70373),s=i(2413);const r={minX:0,minY:0,maxX:0,maxY:0};function a(e,t,i){(function(e){r.minX=e[0],r.minY=e[1],r.maxX=e[2],r.maxY=e[3]})(t),e.search(r,i)}class l{constructor(){this._indexInvalid=!1,this._boundsToLoad=[],this._boundsById=new Map,this._idByBounds=new Map,this._index=new o.w(9,(0,n.A)("esri-csp-restrictions")?e=>({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}):["[0]","[1]","[2]","[3]"]),this._loadIndex=()=>{if(this._indexInvalid){const e=new Array(this._idByBounds.size);let t=0;this._idByBounds.forEach(((i,n)=>{e[t++]=n})),this._indexInvalid=!1,this._index.clear(),this._index.load(e)}else this._boundsToLoad.length&&(this._index.load(Array.from(new Set(this._boundsToLoad.filter((e=>this._idByBounds.has(e)))))),this._boundsToLoad.length=0)}}get fullBounds(){if(!this._boundsById.size)return null;const e=(0,s.Ie)();for(const t of this._boundsById.values())t&&(e[0]=Math.min(t[0],e[0]),e[1]=Math.min(t[1],e[1]),e[2]=Math.max(t[2],e[2]),e[3]=Math.max(t[3],e[3]));return e}get valid(){return!this._indexInvalid}clear(){this._indexInvalid=!1,this._boundsToLoad.length=0,this._boundsById.clear(),this._idByBounds.clear(),this._index.clear()}delete(e){const t=this._boundsById.get(e);this._boundsById.delete(e),t&&(this._idByBounds.delete(t),this._indexInvalid||this._index.remove(t))}forEachInBounds(e,t){this._loadIndex(),a(this._index,e,(e=>t(this._idByBounds.get(e))))}get(e){return this._boundsById.get(e)}has(e){return this._boundsById.has(e)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(e,t){if(!this._indexInvalid){const t=this._boundsById.get(e);t&&(this._index.remove(t),this._idByBounds.delete(t))}this._boundsById.set(e,t),t&&(this._idByBounds.set(t,e),this._indexInvalid||(this._boundsToLoad.push(t),this._boundsToLoad.length>5e4&&this._loadIndex()))}}},72547:(e,t,i)=>{i.d(t,{A:()=>y});var n=i(18690),o=i(50076),s=i(54099),r=i(76460),a=i(42294),l=i(2413),d=i(98618),h=i(33328),p=i(55167),u=i(33376);const c=(0,a.vt)();class y{constructor(e){this.geometryInfo=e,this._boundsStore=new h.F,this._featuresById=new Map,this._markedIds=new Set,this.events=new s.A,this.featureAdapter=u.T}get geometryType(){return this.geometryInfo.geometryType}get hasM(){return this.geometryInfo.hasM}get hasZ(){return this.geometryInfo.hasZ}get numFeatures(){return this._featuresById.size}get fullBounds(){return this._boundsStore.fullBounds}get storeStatistics(){let e=0;return this._featuresById.forEach((t=>{null!=t.geometry&&t.geometry.coords&&(e+=t.geometry.coords.length)})),{featureCount:this._featuresById.size,vertexCount:e/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}}getFullExtent(e){if(null==this.fullBounds)return null;const[t,i,n,o]=this.fullBounds;return{xmin:t,ymin:i,xmax:n,ymax:o,spatialReference:(0,p.ag)(e)}}add(e){this._add(e),this._emitChanged()}addMany(e){for(const t of e)this._add(t);this._emitChanged()}upsertMany(e){const t=e.map((e=>this._upsert(e)));return this._emitChanged(),t.filter(n.Ru)}clear(){this._featuresById.clear(),this._boundsStore.clear(),this._emitChanged()}removeById(e){const t=this._featuresById.get(e);return t?(this._remove(t),this._emitChanged(),t):null}removeManyById(e){this._boundsStore.invalidateIndex();for(const t of e){const e=this._featuresById.get(t);e&&this._remove(e)}this._emitChanged()}forEachBounds(e,t){for(const i of e){const e=this._boundsStore.get(i.objectId);e&&t((0,a.Jt)(c,e))}}getFeature(e){return this._featuresById.get(e)}has(e){return this._featuresById.has(e)}forEach(e){this._featuresById.forEach((t=>e(t)))}forEachInBounds(e,t){this._boundsStore.forEachInBounds(e,(e=>{t(this._featuresById.get(e))}))}startMarkingUsedFeatures(){this._boundsStore.invalidateIndex(),this._markedIds.clear()}sweep(){let e=!1;this._featuresById.forEach(((t,i)=>{this._markedIds.has(i)||(e=!0,this._remove(t))})),this._markedIds.clear(),e&&this._emitChanged()}_emitChanged(){this.events.emit("changed",void 0)}_add(e){var t;if(!e)return;const i=e.objectId;if(null==i)return void r.A.getLogger("esri.layers.graphics.data.FeatureStore").error(new o.A("featurestore:invalid-feature","feature id is missing",{feature:e}));const n=this._featuresById.get(i);let s;if(this._markedIds.add(i),n?(e.displayId=n.displayId,s=this._boundsStore.get(i),this._boundsStore.delete(i)):null!=this.onFeatureAdd&&this.onFeatureAdd(e),null===(t=e.geometry)||void 0===t||null===(t=t.coords)||void 0===t||!t.length)return this._boundsStore.set(i,null),void this._featuresById.set(i,e);s=(0,d.jQ)(null!=s?s:(0,l.vt)(),e.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),null!=s&&this._boundsStore.set(i,s),this._featuresById.set(i,e)}_upsert(e){var t;const i=null===e||void 0===e?void 0:e.objectId;if(null==i)return r.A.getLogger("esri.layers.graphics.data.FeatureStore").error(new o.A("featurestore:invalid-feature","feature id is missing",{feature:e})),null;const n=this._featuresById.get(i);if(!n)return this._add(e),e;this._markedIds.add(i);const{geometry:s,attributes:a}=e;for(const o in a)n.attributes[o]=a[o];return s&&(n.geometry=s,this._boundsStore.set(i,null!==(t=(0,d.jQ)((0,l.vt)(),s,this.geometryInfo.hasZ,this.geometryInfo.hasM))&&void 0!==t?t:null)),n}_remove(e){null!=this.onFeatureRemove&&this.onFeatureRemove(e);const t=e.objectId;return this._markedIds.delete(t),this._boundsStore.delete(t),this._featuresById.delete(t),e}}},40296:(e,t,i)=>{i.d(t,{F0:()=>a,Vx:()=>h,e2:()=>p,f:()=>u});var n=i(81806),o=i(53084),s=i(8298),r=i(44460);function a(e){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===e||"esriGeometryMultipoint"===e?r.Cb:"esriGeometryPolyline"===e?r.yM:r.WR}}}const l=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/;let d=1;function h(e,t){if((0,n.A)("esri-csp-restrictions"))return()=>({[t]:null,...e});try{let i="this.".concat(t," = null;");for(const t in e)i+="this".concat(l.test(t)?".".concat(t):'["'.concat(t,'"]')," = ").concat(JSON.stringify(e[t]),";");const n=new Function("\n      return class AttributesClass$".concat(d++," {\n        constructor() {\n          ").concat(i,";\n        }\n      }\n    "))();return()=>new n}catch(i){return()=>({[t]:null,...e})}}function p(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[{name:"New Feature",description:"",prototype:{attributes:(0,o.o8)(e)}}]}function u(e,t){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:e},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:t,supportsDelete:t,supportsEditing:t,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:t,supportsExceedsLimitStatistics:!0,supportsAsyncConvert3D:!1},query:s.F,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},editing:{supportsGeometryUpdate:t,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsAsyncApplyEdits:!1,zDefault:void 0}}}},68705:(e,t,i)=>{i.d(t,{PB:()=>S,d4:()=>A,ZL:()=>x,sZ:()=>E,yC:()=>M,Vr:()=>w});var n=i(35143),o=(i(35238),i(91967)),s=i(50076),r=i(76460),a=i(87663),l=i(34154),d=i(46053),h=(i(81806),i(47249),i(85842)),p=i(65215),u=i(26346),c=i(80963),y=i(98618),m=i(20176),f=i(19902);class g{constructor(){this._featureLookup=new Map}static getInstance(){return g.instance||(g.instance=new g),g.instance}static resetInstance(){g.instance&&(g.instance=null)}deleteFromStore(e){e.forEach((e=>{this._featureLookup.delete(e)}))}readFromStoreByList(e){const t=[];return e.forEach((e=>{const i=this.readFromStoreById(e);i&&t.push(i)})),t}readFromStoreById(e){var t;return null!==(t=this._featureLookup.get(e))&&void 0!==t?t:null}writeToStore(e,t,i){const n=[];return e.forEach((e=>{if(null===e||void 0===e||!e.id)return;e.properties||(e.properties=[]);let o,s=null;if(i&&e.properties[i]&&(s=(0,y.Ux)(e.properties[i])),"originId"in e&&"destinationId"in e&&(e.properties.ESRI__ORIGIN_ID=e.originId,e.properties.ESRI__DESTINATION_ID=e.destinationId),e.properties[t]=e.id,e.id&&this._featureLookup.has(e.id)&&this._featureLookup.get(e.id).attributes){const n=this._featureLookup.get(e.id),r=JSON.parse(JSON.stringify(Object.assign(n.attributes,e.properties)));i&&e.properties[i]&&(r[i]=(0,f.rS)(e.properties[i])),o=new m.Om(s?JSON.parse(JSON.stringify(s)):null!==n&&void 0!==n&&n.geometry?JSON.parse(JSON.stringify(n.geometry)):null,r,null,e.properties[t])}else o=new m.Om(s?JSON.parse(JSON.stringify(s)):null,e.properties,null,e.properties[t]);this._featureLookup.set(e.id,o),n.push(o)})),n}}var v=i(52451),_=i(35877),T=i(35380),I=i(97015),b=i(76797);const M="ESRI__ID",w="ESRI__ORIGIN_ID",x="ESRI__DESTINATION_ID",E="ESRI__LAYOUT_GEOMETRY",A="ESRI__AGGREGATION_COUNT";let S=class extends o.A{constructor(e){var t,i,n;super(e),this._processingCacheUpdatesLookup=new Map,this.knowledgeGraph=null,this.inclusionModeDefinition={generateAllSublayers:!0,namedTypeDefinitions:new Map},this.entityTypeNames=new Set,this.relationshipTypeNames=new Set,this.geographicLookup=new Map,this.sublayerCaches=new Map,this.nodeConnectionsLookup=new Map,this.relationshipConnectionsLookup=new Map,this.memberIdTypeLookup=new Map;const o=new Map;null!==(t=e.knowledgeGraph.dataModel.entityTypes)&&void 0!==t&&t.forEach((t=>{var i,n;t.name&&(o.set(t.name,"entity"),this._processingCacheUpdatesLookup.set(t.name,[]),e.inclusionModeDefinition&&!(null!==(i=e.inclusionModeDefinition)&&void 0!==i&&i.generateAllSublayers)||this.entityTypeNames.add(t.name),null===(n=t.properties)||void 0===n||n.forEach((e=>{var i;e.geometryType&&"esriGeometryNull"!==e.geometryType&&this.geographicLookup.set(t.name,{name:null!==(i=e.name)&&void 0!==i?i:"",geometryType:e.geometryType})})))})),null!==(i=e.knowledgeGraph.dataModel.relationshipTypes)&&void 0!==i&&i.forEach((t=>{var i,n;t.name&&(o.set(t.name,"relationship"),this._processingCacheUpdatesLookup.set(t.name,[]),e.inclusionModeDefinition&&!(null!==(i=e.inclusionModeDefinition)&&void 0!==i&&i.generateAllSublayers)||this.relationshipTypeNames.add(t.name),null===(n=t.properties)||void 0===n||n.forEach((e=>{var i;e.geometryType&&"esriGeometryNull"!==e.geometryType&&this.geographicLookup.set(t.name,{name:null!==(i=e.name)&&void 0!==i?i:"",geometryType:e.geometryType})})))})),null===(n=e.inclusionModeDefinition)||void 0===n||n.namedTypeDefinitions.forEach(((t,i)=>{var n;if("entity"===o.get(i))this.entityTypeNames.add(i);else{var s;if("relationship"!==o.get(i))return r.A.getLogger(this).warn("A named type, ".concat(i,", was in the inclusion list that wasn't in the data model and will be removed")),void(null===(s=e.inclusionModeDefinition)||void 0===s||s.namedTypeDefinitions.delete(i));this.relationshipTypeNames.add(i)}const l=new Map;null!==(n=t.members)&&void 0!==n&&n.forEach((e=>{(0,a.tE)(this.memberIdTypeLookup,e.id,(()=>new Set)).add(i);const t=this.getById(e.id);t&&l.set(e.id,t)})),this.sublayerCaches.set(i,l)}))}addToLayer(e){e.forEach((e=>{let{typeName:t,id:i}=e;if(!this.inclusionModeDefinition)throw new s.A("knowledge-graph:layer-data-manager","You cannot add to a layer's exclusion list if it was not created with an exclusion list originally");if(this.inclusionModeDefinition.namedTypeDefinitions.has(t)){if(this.inclusionModeDefinition.namedTypeDefinitions.has(t)){const e=this.inclusionModeDefinition.namedTypeDefinitions.get(t);e.members||(e.members=new Map),e.members.set(i,{id:i}),(0,a.tE)(this.memberIdTypeLookup,i,(()=>new Set)).add(t)}}else{const e=new Map;e.set(i,{id:i}),this.inclusionModeDefinition.namedTypeDefinitions.set(t,{useAllData:!1,members:e}),(0,a.tE)(this.memberIdTypeLookup,i,(()=>new Set)).add(t)}}))}getById(e){return g.getInstance().readFromStoreById(e)}async getData(e,t,i){var n;if(t.objectType.name&&null!==(n=this.inclusionModeDefinition)&&void 0!==n&&n.namedTypeDefinitions&&this.inclusionModeDefinition.namedTypeDefinitions.size>0&&!this.inclusionModeDefinition.namedTypeDefinitions.has(t.objectType.name))return[];let o;if(o=e||new I.A({where:"1=1",outFields:["*"]}),"link-chart"===t.parentCompositeLayer.type){var s,r,a;const e=t.parentCompositeLayer,i=this._processingCacheUpdatesLookup.get(null!==(s=t.objectType.name)&&void 0!==s?s:""),n=o.outFields;n&&1===n.length&&n[0]===M&&"1=1"===o.where||await Promise.all(null!==i&&void 0!==i?i:[]);const l=this.sublayerCaches.has(null!==(r=t.objectType.name)&&void 0!==r?r:"")?Array.from(null===(a=this.sublayerCaches.get(t.objectType.name))||void 0===a?void 0:a.values()):[],d=[];return l.forEach((i=>{this.relationshipTypeNames.has(t.objectType.name)?i.geometry=e.relationshipLinkChartDiagramLookup.get(i.attributes[t.objectIdField]):i.geometry=e.entityLinkChartDiagramLookup.get(i.attributes[t.objectIdField]),i.attributes[E]=i.geometry,d.push(i)})),d}return this.retrieveDataFromService(o,t,i)}async getConnectedRecordIds(e,t){const i=[];let n="";const o=[],s=new Map;if(e.forEach((e=>{if(this.memberIdTypeLookup.has(e))for(const i of this.memberIdTypeLookup.get(e)){var t;if(!this.entityTypeNames.has(i))return;s.has(i)?null===(t=s.get(i))||void 0===t||t.push(e):s.set(i,[e])}})),t&&0!==(null===t||void 0===t?void 0:t.length)){for(const e of t)n=n+e+"|";n=n.slice(0,-1)}return s.forEach(((e,s)=>{let a;a=t&&0!==(null===t||void 0===t?void 0:t.length)?"MATCH (n:".concat(s,")-[r:").concat(n,"]-(m) WHERE id(n) IN $ids RETURN id(r), type(r), id(m), labels(m)[0]"):"MATCH (n:".concat(s,")-[r]-(m) WHERE id(n) IN $ids RETURN id(r), type(r), id(m), labels(m)[0]");const l=new Promise((t=>{(async()=>{const t=(await(0,_.executeQueryStreaming)(this.knowledgeGraph,new T.A({openCypherQuery:a,bindParameters:{ids:e}}))).resultRowsStream.getReader();try{for(;;){const{done:e,value:n}=await t.read();if(e)break;for(let t=0;t<n.length;t++){const e=n[t];i.push({id:e[0],typeName:e[1]}),i.push({id:e[2],typeName:e[3]})}}}catch(n){if("AbortError"!==n.name)throw n;r.A.getLogger(this).info("Request aborted as expected")}})().then((()=>{t()}))}));o.push(l)})),this.refreshCacheContent(),await Promise.all(o),i}async refreshCacheContent(e,t,i){var n,o,r,l,d;let h=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const p=g.getInstance(),u=[],c=new Map,y=new Map;null!==(n=this.knowledgeGraph.dataModel.entityTypes)&&void 0!==n&&n.forEach((e=>{e.name&&y.set(e.name,e)})),null!==(o=this.knowledgeGraph.dataModel.relationshipTypes)&&void 0!==o&&o.forEach((e=>{e.name&&y.set(e.name,e)})),e||this.inclusionModeDefinition?e?e.forEach((e=>{if(this.memberIdTypeLookup.has(e))for(const i of this.memberIdTypeLookup.get(e)){var t;c.has(i)?null===(t=c.get(i))||void 0===t||t.push(e):c.set(i,[e])}})):null===(r=this.inclusionModeDefinition)||void 0===r||null===(r=r.namedTypeDefinitions)||void 0===r||r.forEach(((e,t)=>{e.useAllData?c.set(t,null):e.members&&e.members.forEach((e=>{var i;c.has(t)&&null!==c.get(t)?null===(i=c.get(t))||void 0===i||i.push(e.id):c.set(t,[e.id])}))})):(null!==(l=this.knowledgeGraph.dataModel.entityTypes)&&void 0!==l&&l.forEach((e=>{e.name&&c.set(e.name,null)})),null===(d=this.knowledgeGraph.dataModel.entityTypes)||void 0===d||d.forEach((e=>{e.name&&c.set(e.name,null)})));for(const[f,g]of c){var m;const e=new Promise((e=>{(async()=>{var e;const n=new Set,o=[];let r,l="",d=!1;if(t||null!==(e=y.get(f))&&void 0!==e&&null!==(e=e.properties)&&void 0!==e&&e.forEach((e=>{e.name&&n.add(e.name)})),i&&this.geographicLookup.has(f)){var u;const e=null===(u=this.geographicLookup.get(f))||void 0===u?void 0:u.name;e&&n.add(e)}if(this.entityTypeNames.has(f))l="MATCH (n:".concat(f,") ").concat(g?"WHERE id(n) IN $ids ":"","return ID(n)"),n.forEach((e=>{l+=", n.".concat(e),o.push(e)}));else{if(!this.relationshipTypeNames.has(f))throw new s.A("knowledge-graph:layer-data-manager","The graph type of ".concat(f," could not be determined. Was this type set in the KG data model and inclusion definition?"));d=!0,l="MATCH ()-[n:".concat(f,"]->() ").concat(g?"WHERE id(n) IN $ids ":"","return ID(n), id(startNode(n)), id(endNode(n))"),n.forEach((e=>{l+=", n.".concat(e),o.push(e)}))}r=new T.A(g?{openCypherQuery:l,bindParameters:{ids:g}}:{openCypherQuery:l});const c=(await(0,_.executeQueryStreaming)(this.knowledgeGraph,r)).resultRowsStream.getReader();for(;;){var m,v,I,b;const{done:e,value:t}=await c.read();if(e)break;const i=[];for(let r=0;r<t.length;r++){const e=t[r];let n=0,s=0;const l={properties:{}};for(l.id=e[n],n++,s++,d&&(l.originId=e[n],n++,s++,l.destinationId=e[n],n++,s++,(0,a.tE)(this.nodeConnectionsLookup,l.originId,(()=>new Set)).add(l.id),(0,a.tE)(this.nodeConnectionsLookup,l.destinationId,(()=>new Set)).add(l.id),(0,a.tE)(this.relationshipConnectionsLookup,l.id,(()=>[l.originId,l.destinationId])));n<e.length;n++)l.properties[o[n-s]]=e[n];i.push(l)}const n=p.writeToStore(i,M,null===(m=this.geographicLookup.get(f))||void 0===m?void 0:m.name);this.sublayerCaches.has(f)||this.sublayerCaches.set(f,new Map),h&&!(null!==(v=this.inclusionModeDefinition)&&void 0!==v&&v.namedTypeDefinitions.has(f))&&null!==(I=this.inclusionModeDefinition)&&void 0!==I&&I.namedTypeDefinitions.set(f,{useAllData:!1,members:new Map}),h&&(null===(b=this.inclusionModeDefinition)||void 0===b||!b.namedTypeDefinitions.get(f).members)&&(this.inclusionModeDefinition.namedTypeDefinitions.get(f).members=new Map);const s=this.sublayerCaches.get(f);n.forEach((e=>{var t,i;null!==s&&void 0!==s&&s.set(e.attributes[M],e),h&&(null===(t=this.inclusionModeDefinition)||void 0===t||!t.namedTypeDefinitions.get(f).members.has(e.attributes[M]))&&(null!==(i=this.inclusionModeDefinition)&&void 0!==i&&i.namedTypeDefinitions.get(f).members.set(e.attributes[M],{id:e.attributes[M]}),(0,a.tE)(this.memberIdTypeLookup,e.attributes[M],(()=>new Set)).add(f))}))}})().then((()=>{e(null)}))}));u.push(e),null===(m=this._processingCacheUpdatesLookup.get(f))||void 0===m||m.push(e)}await Promise.all(u)}removeFromLayer(e){const t=new Set,i=new Set(e.map((e=>e.id)));for(const r of e){var n,o,s;t.add(r.typeName),1===(null===(n=this.memberIdTypeLookup.get(r.id))||void 0===n?void 0:n.size)?this.memberIdTypeLookup.delete(r.id):null===(o=this.memberIdTypeLookup.get(r.id))||void 0===o||o.delete(r.typeName),null===(s=this.inclusionModeDefinition)||void 0===s||s.namedTypeDefinitions.forEach(((e,t)=>{var i;t===r.typeName&&(null===(i=e.members)||void 0===i?void 0:i.has(r.id))&&e.members.delete(r.id)}))}t.forEach((e=>{var t;null===(t=this.sublayerCaches.get(e))||void 0===t||t.forEach(((t,n)=>{var o;i.has(n)&&(null===(o=this.sublayerCaches.get(e))||void 0===o||o.delete(n))}))}))}async retrieveDataFromService(e,t,i){var n,o,r;const a=g.getInstance(),d=new Set,h=[];let y,m="",f=[];const I="relationship"===t.graphType,w=null===(n=this.inclusionModeDefinition)||void 0===n||null===(n=n.namedTypeDefinitions)||void 0===n||null===(n=n.get(t.objectType.name))||void 0===n?void 0:n.useAllData,x=t.parentCompositeLayer.sublayerIdsCache.get(t.objectType.name);let E=!w&&x?Array.from(x).sort():null;if(null!==(o=this.inclusionModeDefinition)&&void 0!==o&&null!==(o=o.namedTypeDefinitions)&&void 0!==o&&null!==(o=o.get(t.objectType.name))&&void 0!==o&&o.useAllData)(null===(r=this.inclusionModeDefinition)||void 0===r||null===(r=r.namedTypeDefinitions)||void 0===r||null===(r=r.get(t.objectType.name))||void 0===r?void 0:r.useAllData)&&null!=e.objectIds&&(E=e.objectIds);else if(null!=e.objectIds&&E&&E.length>0){const t=e.objectIds;e.objectIds=E.filter((e=>t.includes(e)))}else if(null!=e.objectIds)E=e.objectIds;else{var A,S,D;if(null!==(A=this.inclusionModeDefinition)&&void 0!==A&&A.namedTypeDefinitions.has(t.objectType.name)&&(null===(S=this.inclusionModeDefinition.namedTypeDefinitions.get(t.objectType.name))||void 0===S||!S.members||(null===(D=this.inclusionModeDefinition.namedTypeDefinitions.get(t.objectType.name))||void 0===D||null===(D=D.members)||void 0===D?void 0:D.size)<1))return e.objectIds=[],[];e.objectIds=E}if(null!=e.outFields){const i=e.outFields;i.includes("*")?t.fields.forEach((e=>{d.add(e.name)})):i.forEach((e=>{e!==M&&e!==t.geometryFieldName&&d.add(e)}))}if(null!=e.geometry){var N,B,L;const i=e.geometry;let n;const o=t.parentCompositeLayer.dataManager.knowledgeGraph.serviceDefinition,r=null===o||void 0===o?void 0:o.spatialReference,a=null===o||void 0===o||null===(N=o.serviceCapabilities)||void 0===N?void 0:N.geometryCapabilities;let f=null===a||void 0===a?void 0:a.geometryMaxBoundingRectangleSizeX,g=null===a||void 0===a?void 0:a.geometryMaxBoundingRectangleSizeY;if(null===i||void 0===i||null===(B=i.extent)||void 0===B||!B.spatialReference||null!==(L=i.spatialReference)&&void 0!==L&&L.isWGS84?n=i.extent:(await(0,u.initializeProjection)(i.extent.spatialReference,c.KK),n=(0,u.project)(i.extent,c.KK)),f&&g&&r){if(4326!==r.wkid){const e=new b.A({spatialReference:r,xmax:f,ymax:g}),t=(0,u.project)(e,c.KK);f=t.xmax,g=t.ymax}if(n.xmax-n.xmin>f)throw new s.A("knowledge-graph:layer-data-manager","Extent x bounds should be within ".concat(f,"\xb0 latitude, limit exceeded"));if(n.ymax-n.ymin>g)throw new s.A("knowledge-graph:layer-data-manager","Extent y bounds should be within ".concat(g,"\xb0 longitude, limit exceeded"))}if(null!=e.where&&"1=1"!==e.where){const i=await(0,l.G)(e.where.toUpperCase(),t.fieldsIndex);t.fields.forEach((e=>{i.fieldNames.includes(e.name)&&d.add(e.name)}))}m=I?"Match ()-[n:".concat(t.objectType.name,"]->() WHERE esri.graph.ST_Intersects($param_filter_geom, n.").concat(t.geometryFieldName,") return ID(n), id(startNode(r)), id(endNode(r))"):"Match (n:".concat(t.objectType.name,") WHERE esri.graph.ST_Intersects($param_filter_geom, n.").concat(t.geometryFieldName,") return ID(n)"),t.geometryFieldName&&d.add(t.geometryFieldName),d.forEach((e=>{m+=", n.".concat(e),h.push(e)})),y=new T.A({openCypherQuery:m,bindParameters:{param_filter_geom:new p.A({rings:(0,v.DX)(n)})}})}else{let i="";if(null!=e.where&&"1=1"!==e.where){const n=await(0,l.G)(e.where,t.fieldsIndex);t.fields.forEach((e=>{n.fieldNames.includes(e.name)&&d.add(e.name)}));const o=new Set(["column-reference","string","number","binary-expression"]),s=new Set(["=","<","<=","<>",">",">=","AND","OR","LIKE"]);let r=!1;const a=e=>{if("column-reference"===e.type)return"n.".concat(e.column);if("string"===e.type)return"'".concat(e.value,"'");if("number"===e.type)return"".concat(e.value);if("binary-expression"===e.type&&o.has(e.left.type)&&o.has(e.right.type)&&s.has(e.operator))return"".concat(a(e.left)," ").concat(e.operator," ").concat(a(e.right));if("binary-expression"===e.type&&"LIKE"===e.operator){let t="";if("function"===e.left.type&&"column-reference"===e.left.args.value[0].type)t+="lower(n.".concat(e.left.args.value[0].column,")");else{if("column-reference"!==e.left.type)return r=!0,"";t+="lower(n.".concat(e.left.column,")")}if(t+=" CONTAINS (","string"!==e.right.type)return r=!0,"";{let i=e.right.value;"%"===i.charAt(0)&&(i=i.slice(1)),"%"===i.charAt(i.length-1)&&(i=i.slice(0,-1)),t+="'".concat(i.toLowerCase(),"')")}return t}return r=!0,""};i=a(n.parseTree),r&&(i="")}let n="";n=I?"Match ()-[n:".concat(t.objectType.name,"]->()"):"Match (n:".concat(t.objectType.name,")");let o=!1;E&&(o=!0,n+=" WHERE ID(n) IN $ids"),i&&(n+=o?" AND":" WHERE",n+=" ".concat(i)),n+=" return ID(n)",I&&(n+=", id(startNode(n)), id(endNode(n))"),e.returnGeometry&&t.geometryFieldName&&d.add(t.geometryFieldName),d.forEach((e=>{n+=", n.".concat(e),h.push(e)})),y=new T.A(E?{openCypherQuery:n,bindParameters:{ids:E}}:{openCypherQuery:n})}const C=(await(0,_.executeQueryStreaming)(t.parentCompositeLayer.dataManager.knowledgeGraph,y,i)).resultRowsStream.getReader();for(;;){var k;const{done:e,value:i}=await C.read();if(e)break;const n=[];for(let t=0;t<i.length;t++){const e=i[t];let o=0,s=0;const r={properties:{}};for(r.id=e[o],o++,s++,I&&(r.originId=e[o],o++,s++,r.destinationId=e[o],o++,s++);o<e.length;o++)r.properties[h[o-s]]=e[o];n.push(r)}f=f.concat(a.writeToStore(n,M,null===(k=t.parentCompositeLayer.dataManager.geographicLookup.get(t.objectType.name))||void 0===k?void 0:k.name))}return f}};(0,n._)([(0,d.MZ)()],S.prototype,"knowledgeGraph",void 0),(0,n._)([(0,d.MZ)()],S.prototype,"inclusionModeDefinition",void 0),(0,n._)([(0,d.MZ)()],S.prototype,"entityTypeNames",void 0),(0,n._)([(0,d.MZ)()],S.prototype,"relationshipTypeNames",void 0),(0,n._)([(0,d.MZ)()],S.prototype,"geographicLookup",void 0),(0,n._)([(0,d.MZ)()],S.prototype,"sublayerCaches",void 0),(0,n._)([(0,d.MZ)()],S.prototype,"nodeConnectionsLookup",void 0),(0,n._)([(0,d.MZ)()],S.prototype,"relationshipConnectionsLookup",void 0),(0,n._)([(0,d.MZ)()],S.prototype,"memberIdTypeLookup",void 0),S=(0,n._)([(0,h.$)("esri.layers.knowledgeGraph.KnowledgeGraphLayerDataManager")],S)},83716:(e,t,i)=>{i.d(t,{A:()=>k});var n=i(35143),o=(i(35238),i(16868)),s=(i(63844),i(14873),i(47662),i(72690),i(86946),i(71832),i(5766),i(35039),i(86616)),r=i(31382),a=(i(16783),i(46053)),l=(i(81806),i(76460),i(47249),i(85842)),d=i(26346),h=i(80963),p=i(25515),u=i(72547),c=i(16744),y=i(40296),m=i(68705);const f=(0,i(76350).p)(),g=e=>{let t=class extends e{constructor(){super(...arguments),this.fields=[],this.fieldsIndex=null}};return(0,n._)([(0,a.MZ)(f.fields)],t.prototype,"fields",void 0),(0,n._)([(0,a.MZ)(f.fieldsIndex)],t.prototype,"fieldsIndex",void 0),t=(0,n._)([(0,l.$)("esri.layers.knowledgeGraph.KnowledgeGraphSublayerBase")],t),t};var v=i(65624),_=i(71448),T=i(21617),I=i(5682),b=i(95363),M=i(44135),w=i(53430),x=i(77725),E=i(97015),A=i(30973),S=i(59989),D=i(76797),N=i(65215),B=i(23701),L=i(31608);let C=class extends((0,_.J)(g((0,v.d)((0,I.j)((0,T.J)(p.A)))))){constructor(e){var t,i,n,o,r;if(super(e),t=this,this.capabilities=(0,y.f)(!1,!1),this.definitionExpression="",this.displayField="",this.elevationInfo=null,this.geometryType=null,this.geometryFieldName=null,this.graphType=null,this.hasM=!1,this.hasZ=!1,this.labelsVisible=null,this.labelingInfo=null,this.objectIdField=m.yC,this.objectType=null,this.parentCompositeLayer=null,this.popupEnabled=!0,this.popupTemplate=null,this.source={openPorts:()=>this.load().then((()=>{const e=new MessageChannel;return new S.A(e.port1,{channel:e,client:{queryFeatures:function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=E.A.fromJSON(e);return t.queryFeaturesJSON(n,i)}}}),[e.port2]}))},this.type="knowledge-graph-sublayer","link-chart"===e.parentCompositeLayer.type)"relationship"===e.graphType?this.geometryType="polyline":this.geometryType="point",this.geometryFieldName=m.sZ;else if(null!==(i=e.parentCompositeLayer.dataManager.geographicLookup.get(e.objectType.name))&&void 0!==i&&i.geometryType&&"esriGeometryNull"!==(null===(n=e.parentCompositeLayer.dataManager.geographicLookup.get(e.objectType.name))||void 0===n?void 0:n.geometryType)){var a,l,d,h;const t=e.parentCompositeLayer.dataManager.geographicLookup.get(e.objectType.name);this.geometryFieldName=null!==(a=null===t||void 0===t?void 0:t.name)&&void 0!==a?a:null,this.geometryType=null!==t&&void 0!==t&&t.geometryType?L.g.fromJSON(t.geometryType):null;const i=null===t||void 0===t?void 0:t.name,n=i?null===(l=e.objectType.properties)||void 0===l?void 0:l[i]:null;n?(this.hasM=null!==(d=n.hasM)&&void 0!==d&&d,this.hasZ=null!==(h=n.hasZ)&&void 0!==h&&h):(this.hasM=!1,this.hasZ=!1)}else this.geometryType=null;null!==(o=e.objectType.properties)&&void 0!==o&&o.forEach((e=>{let t=e.fieldType;"esriFieldTypeOID"===t&&(t="esriFieldTypeInteger"),this.fields.push(M.A.fromJSON({name:e.name,type:t,alias:e.alias,defaultValue:null,editable:e.editable,nullable:e.nullable}))})),this.fields.push(M.A.fromJSON({name:this.objectIdField,type:"esriFieldTypeString",alias:this.objectIdField,editable:!1})),this.fields.push(M.A.fromJSON({name:m.d4,type:"esriFieldTypeInteger",alias:m.d4,editable:!1})),this._set("fields",[...this.fields]),null!==(r=e.parentCompositeLayer.dataManager.knowledgeGraph.dataModel)&&void 0!==r&&r.spatialReference&&(this.spatialReference=e.parentCompositeLayer.dataManager.knowledgeGraph.dataModel.spatialReference),"link-chart"===e.parentCompositeLayer.type?"relationship"===e.graphType?this.renderer=(0,s.r)((0,y.F0)(L.g.toJSON("polyline")).renderer):this.renderer=(0,s.r)((0,y.F0)(L.g.toJSON("point")).renderer):this.renderer=(0,s.r)((0,y.F0)(L.g.toJSON(this.geometryType)).renderer)}get defaultPopupTemplate(){return this.createPopupTemplate()}set renderer(e){(0,w.yp)(e,this.fieldsIndex),this._set("renderer",e)}createPopupTemplate(e){return(0,A.tn)(this,e)}createQuery(){return new E.A({where:"1=1",outFields:["*"]})}getField(e){for(let t=0;t<this.fields.length;t++)if(this.fields[t].name===e)return this.fields[t];return null}getFieldDomain(e,t){return null}async queryFeatures(e,t){const{resolvedQuery:i,queryEngine:n}=await this._setupQueryObjects(e),o=x.A.fromJSON(await n.executeQuery(i.toJSON(),null===t||void 0===t?void 0:t.signal));return o.features.forEach((e=>{e.sourceLayer=this})),o}async queryFeaturesJSON(e,t){const{resolvedQuery:i,queryEngine:n}=await this._setupQueryObjects(e);return await n.executeQuery(i.toJSON(),null===t||void 0===t?void 0:t.signal)}async queryFeatureCount(e,t){const{resolvedQuery:i,queryEngine:n}=await this._setupQueryObjects(e);return n.executeQueryForCount(i.toJSON(),null===t||void 0===t?void 0:t.signal)}async queryExtent(){var e,t,i,n;let o=arguments.length>1?arguments[1]:void 0;const s={...arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},returnGeometry:!0},{resolvedQuery:r,queryEngine:a}=await this._setupQueryObjects(s),l=await a.executeQueryForExtent(r.toJSON(),null===o||void 0===o?void 0:o.signal);let d;return d=null!=(null===(e=l.extent)||void 0===e?void 0:e.xmin)&&null!=(null===(t=l.extent)||void 0===t?void 0:t.xmax)&&null!=(null===(i=l.extent)||void 0===i?void 0:i.ymin)&&null!=(null===(n=l.extent)||void 0===n?void 0:n.ymax)?new D.A(l.extent):new D.A,{count:l.count,extent:d}}async queryObjectIds(e,t){const i=E.A.from(e);let n;if("link-chart"===this.parentCompositeLayer.type&&this._cachedQueryEngine)n=this._cachedQueryEngine;else{const e=await this.parentCompositeLayer.dataManager.getData(i,this,t);n=this.loadQueryEngine(e)}return n.executeQueryForIds(i.toJSON(),null===t||void 0===t?void 0:t.signal)}loadQueryEngine(e){const t=new u.A({geometryType:L.g.toJSON(this.geometryType),hasM:this.hasM,hasZ:this.hasZ}),i=new c.d({fieldsIndex:this.fieldsIndex.toJSON(),geometryType:L.g.toJSON(this.geometryType),hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:this.spatialReference.toJSON(),timeInfo:null,featureStore:t});return i.featureStore.addMany(e),i}async refreshCachedQueryEngine(){const e=await this.parentCompositeLayer.dataManager.getData(new E.A({where:"1=1",outFields:[m.yC]}),this);this._cachedQueryEngine=this.loadQueryEngine(e)}async _setupQueryObjects(e,t){var i;const n=E.A.from(e),o=n.geometry;let s;if(o&&!(null!==(i=o.spatialReference)&&void 0!==i&&i.isWGS84)&&(await(0,d.initializeProjection)(o.spatialReference,h.KK),n.geometry=(0,d.project)(o instanceof N.A||o instanceof B.A?o:o.extent,h.KK)),"link-chart"===this.parentCompositeLayer.type&&this._cachedQueryEngine)s=this._cachedQueryEngine;else{const e=await this.parentCompositeLayer.dataManager.getData(n,this,t);s=this.loadQueryEngine(e)}return{resolvedQuery:n,queryEngine:s}}};(0,n._)([(0,a.MZ)()],C.prototype,"capabilities",void 0),(0,n._)([(0,a.MZ)({readOnly:!0})],C.prototype,"defaultPopupTemplate",null),(0,n._)([(0,a.MZ)()],C.prototype,"definitionExpression",void 0),(0,n._)([(0,a.MZ)()],C.prototype,"displayField",void 0),(0,n._)([(0,a.MZ)()],C.prototype,"elevationInfo",void 0),(0,n._)([(0,a.MZ)()],C.prototype,"geometryType",void 0),(0,n._)([(0,a.MZ)()],C.prototype,"geometryFieldName",void 0),(0,n._)([(0,a.MZ)()],C.prototype,"graphType",void 0),(0,n._)([(0,a.MZ)()],C.prototype,"hasM",void 0),(0,n._)([(0,a.MZ)()],C.prototype,"hasZ",void 0),(0,n._)([(0,a.MZ)()],C.prototype,"labelsVisible",void 0),(0,n._)([(0,a.MZ)()],C.prototype,"labelingInfo",void 0),(0,n._)([(0,a.MZ)()],C.prototype,"objectIdField",void 0),(0,n._)([(0,a.MZ)()],C.prototype,"objectType",void 0),(0,n._)([(0,a.MZ)()],C.prototype,"parentCompositeLayer",void 0),(0,n._)([(0,a.MZ)(b.M6)],C.prototype,"popupEnabled",void 0),(0,n._)([(0,a.MZ)({type:o.A,json:{name:"popupInfo",write:!0}})],C.prototype,"popupTemplate",void 0),(0,n._)([(0,a.MZ)({types:r.H,json:{write:{target:"layerDefinition.drawingInfo.renderer"}}})],C.prototype,"renderer",null),(0,n._)([(0,a.MZ)()],C.prototype,"source",void 0),(0,n._)([(0,a.MZ)({json:{read:!1}})],C.prototype,"type",void 0),C=(0,n._)([(0,l.$)("esri.layers.knowledgeGraph.KnowledgeGraphSublayer")],C);const k=C},52451:(e,t,i)=>{i.d(t,{DX:()=>c,aq:()=>y});i(3825);var n,o=i(50076),s=(i(98618),i(35877)),r=i(35380);i(35238),i(13312);!function(e){e.ELEMENTUID="ELEMENTUID",e.TYPENAME="TYPENAME"}(n||(n={}));n.ELEMENTUID,n.TYPENAME;var a,l;!function(e){e[e.ELEMENTUID=0]="ELEMENTUID",e[e.TYPENAME=1]="TYPENAME"}(a||(a={})),function(e){e[e.ELEMENTUID=0]="ELEMENTUID",e[e.TYPENAME=1]="TYPENAME",e[e.FROMUID=2]="FROMUID",e[e.TOUID=3]="TOUID"}(l||(l={}));var d,h,p,u;i(57502),i(31830);function c(e){if(!e.spatialReference.isWGS84)throw new o.A("knowledge-graph:layer-support-utils","The extentToInBoundsRings function only supports WGS84 spatial references.");return e.clone().normalize().map((e=>[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]))}async function y(e,t){var i;const n=[],o=new Map,a=[];if(null!==(i=t.dataModel)&&void 0!==i&&i.relationshipTypes)for(const s of t.dataModel.relationshipTypes)s.name&&o.set(s.name,[]);for(const s of e){var l;o.has(s.typeName)&&(null===(l=o.get(s.typeName))||void 0===l||l.push(s.id))}for(const[d,h]of o){if(h.length<1)continue;const e=new r.A({openCypherQuery:"MATCH (n)-[r:".concat(d,"]->(m) WHERE id(r) in $ids RETURN id(n), labels(n)[0], id(m), labels(m)[0]"),bindParameters:{ids:h}});a.push((0,s.executeQueryStreaming)(t,e).then((async e=>{const t=e.resultRowsStream.getReader();for(;;){const{done:e,value:i}=await t.read();if(e)break;for(const t of i)n.push({id:t[0],typeName:t[1]}),n.push({id:t[2],typeName:t[3]})}})))}return await Promise.all(a),n}!function(e){e[e.featureResult=0]="featureResult",e[e.countResult=1]="countResult",e[e.idsResult=2]="idsResult"}(d||(d={})),function(e){e[e.upperLeft=0]="upperLeft",e[e.lowerLeft=1]="lowerLeft"}(h||(h={})),function(e){e[e.sqlTypeBigInt=0]="sqlTypeBigInt",e[e.sqlTypeBinary=1]="sqlTypeBinary",e[e.sqlTypeBit=2]="sqlTypeBit",e[e.sqlTypeChar=3]="sqlTypeChar",e[e.sqlTypeDate=4]="sqlTypeDate",e[e.sqlTypeDecimal=5]="sqlTypeDecimal",e[e.sqlTypeDouble=6]="sqlTypeDouble",e[e.sqlTypeFloat=7]="sqlTypeFloat",e[e.sqlTypeGeometry=8]="sqlTypeGeometry",e[e.sqlTypeGUID=9]="sqlTypeGUID",e[e.sqlTypeInteger=10]="sqlTypeInteger",e[e.sqlTypeLongNVarchar=11]="sqlTypeLongNVarchar",e[e.sqlTypeLongVarbinary=12]="sqlTypeLongVarbinary",e[e.sqlTypeLongVarchar=13]="sqlTypeLongVarchar",e[e.sqlTypeNChar=14]="sqlTypeNChar",e[e.sqlTypeNVarChar=15]="sqlTypeNVarChar",e[e.sqlTypeOther=16]="sqlTypeOther",e[e.sqlTypeReal=17]="sqlTypeReal",e[e.sqlTypeSmallInt=18]="sqlTypeSmallInt",e[e.sqlTypeSqlXml=19]="sqlTypeSqlXml",e[e.sqlTypeTime=20]="sqlTypeTime",e[e.sqlTypeTimestamp=21]="sqlTypeTimestamp",e[e.sqlTypeTimestamp2=22]="sqlTypeTimestamp2",e[e.sqlTypeTinyInt=23]="sqlTypeTinyInt",e[e.sqlTypeVarbinary=24]="sqlTypeVarbinary",e[e.sqlTypeVarchar=25]="sqlTypeVarchar"}(p||(p={})),function(e){e[e.OID_ARRAY=0]="OID_ARRAY",e[e.GLOBALID_ARRAY=1]="GLOBALID_ARRAY",e[e.STRING_ARRAY=2]="STRING_ARRAY",e[e.IDENTIFIER_ARRAY=3]="IDENTIFIER_ARRAY"}(u||(u={}))},9505:(e,t,i)=>{i.d(t,{A:()=>d});var n=i(35143),o=(i(35238),i(46053)),s=(i(81806),i(76460),i(47249),i(85842)),r=i(27544),a=i(13904);let l=class extends r.A{constructor(e){super(e),this.layoutGeometry=null}};(0,n._)([(0,o.MZ)({type:a.A,json:{write:!0}})],l.prototype,"layoutGeometry",void 0),l=(0,n._)([(0,s.$)("esri.rest.knowledgeGraph.Entity")],l);const d=l},27544:(e,t,i)=>{i.d(t,{A:()=>l});var n=i(35143),o=i(46053),s=(i(81806),i(76460),i(47249),i(85842)),r=i(12831);let a=class extends r.A{constructor(e){super(e),this.typeName=null,this.id=null}};(0,n._)([(0,o.MZ)({type:String,json:{write:!0}})],a.prototype,"typeName",void 0),(0,n._)([(0,o.MZ)({type:String,json:{write:!0}})],a.prototype,"id",void 0),a=(0,n._)([(0,s.$)("esri.rest.knowledgeGraph.GraphNamedObject")],a);const l=a},12831:(e,t,i)=>{i.d(t,{A:()=>l});var n=i(35143),o=i(42553),s=i(46053),r=(i(81806),i(76460),i(47249),i(85842));let a=class extends o.oY{constructor(e){super(e),this.properties=null}};(0,n._)([(0,s.MZ)({json:{write:!0}})],a.prototype,"properties",void 0),a=(0,n._)([(0,r.$)("esri.rest.knowledgeGraph.GraphObject")],a);const l=a},35380:(e,t,i)=>{i.d(t,{A:()=>h});var n=i(35143),o=i(46053),s=(i(81806),i(76460),i(47249),i(85842)),r=i(91967);let a=class extends r.A{constructor(e){super(e),this.openCypherQuery=""}};(0,n._)([(0,o.MZ)()],a.prototype,"openCypherQuery",void 0),a=(0,n._)([(0,s.$)("esri.rest.knowledgeGraph.GraphQuery")],a);const l=a;let d=class extends l{constructor(e){super(e),this.bindParameters=null,this.bindGeometryQuantizationParameters=null,this.outputQuantizationParameters=null,this.outputSpatialReference=null}};(0,n._)([(0,o.MZ)()],d.prototype,"bindParameters",void 0),(0,n._)([(0,o.MZ)()],d.prototype,"bindGeometryQuantizationParameters",void 0),(0,n._)([(0,o.MZ)()],d.prototype,"outputQuantizationParameters",void 0),(0,n._)([(0,o.MZ)()],d.prototype,"outputSpatialReference",void 0),d=(0,n._)([(0,s.$)("esri.rest.knowledgeGraph.GraphQueryStreaming")],d);const h=d},38156:(e,t,i)=>{i.d(t,{A:()=>a});var n=i(35143),o=(i(76460),i(81806),i(47249),i(50076),i(85842)),s=i(12831);let r=class extends s.A{constructor(e){super(e)}};r=(0,n._)([(0,o.$)("esri.rest.knowledgeGraph.ObjectValue")],r);const a=r},68325:(e,t,i)=>{i.d(t,{A:()=>d});var n=i(35143),o=i(42553),s=i(46053),r=(i(81806),i(76460),i(47249),i(85842)),a=i(12831);let l=class extends o.oY{constructor(e){super(e),this.path=null}};(0,n._)([(0,s.MZ)({type:[a.A],json:{write:!0}})],l.prototype,"path",void 0),l=(0,n._)([(0,r.$)("esri.rest.knowledgeGraph.Path")],l);const d=l},23908:(e,t,i)=>{i.d(t,{A:()=>d});var n=i(35143),o=(i(35238),i(46053)),s=(i(81806),i(76460),i(47249),i(85842)),r=i(27544),a=i(23701);let l=class extends r.A{constructor(e){super(e),this.originId=null,this.destinationId=null,this.layoutGeometry=null}};(0,n._)([(0,o.MZ)({type:String,json:{write:!0}})],l.prototype,"originId",void 0),(0,n._)([(0,o.MZ)({type:String,json:{write:!0}})],l.prototype,"destinationId",void 0),(0,n._)([(0,o.MZ)({type:a.A,json:{write:!0}})],l.prototype,"layoutGeometry",void 0),l=(0,n._)([(0,s.$)("esri.rest.knowledgeGraph.Relationship")],l);const d=l}}]);
//# sourceMappingURL=7118.ac8542be.chunk.js.map